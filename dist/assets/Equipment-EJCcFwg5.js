import{v as S,e as f,r as y,j as e,u as D,m as J,d as P,i as R,E as g,l as T}from"./index-B-QOVXil.js";import{S as A,W as U,g as Q}from"./App-gCA-TVeX.js";import{u as B}from"./useEquipmentFavorites-nLe_T5O1.js";const L=({status:t})=>{const{t:s}=f(),i={[g.Available]:{text:s("available"),color:"bg-green-100 text-green-800",dot:"bg-green-500"},[g.InUse]:{text:s("statusInUse"),color:"bg-red-100 text-red-800",dot:"bg-red-500"},[g.Maintenance]:{text:s("maintenance"),color:"bg-yellow-100 text-yellow-800",dot:"bg-yellow-500"},[g.Calibration]:{text:s("calibration"),color:"bg-blue-100 text-blue-800",dot:"bg-blue-500"}}[t];return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.color}`,children:[e.jsx("span",{className:`w-2 h-2 mr-1.5 rounded-full ${i.dot}`}),i.text]})},V=({equipment:t})=>{const{currentUser:s}=D(),{t:a,isJapanese:i}=f(),{qualifications:o,userCertifications:u}=J(),m=P(),{openModal:l}=R(),{isFavorite:r,toggleFavorite:b}=B(),d=s?r(s.id,t.id):!1,p=x=>{x.stopPropagation(),s&&b(s.id,t.id)},n=t.requiredQualificationId,c=u.find(x=>x.userId===(s==null?void 0:s.id)&&x.qualificationId===n&&new Date<new Date(x.expiresAt)),v=!n||!!c,h=n?o.find(x=>x.id===n):null,j=t.nextCalibrationDate&&new Date(t.nextCalibrationDate)<new Date,w=t.isReservable&&t.status===g.Available&&v&&!j,N=i?t.nameJP:t.nameEN,I=i?t.categoryJP:t.categoryEN,F=i?t.rateUnitJP:t.rateUnitEN,$=h?i?h.nameJP:h.nameEN:"",k=t.personInChargeUserId?m.find(x=>x.id===t.personInChargeUserId):null,C=i?t.locationDetailsJP:t.locationDetailsEN,M=()=>{if(!t.isReservable)return a("notReservable");if(j)return a("calibrationOverdue");if(!v){if(!c&&n){const x=u.some(E=>E.userId===(s==null?void 0:s.id)&&E.qualificationId===n);return a(x?"certExpired":"noCert")}return a("noCert")}return t.status!==g.Available?a("notAvailable"):""};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden flex flex-col relative",children:[e.jsx("button",{onClick:p,className:"absolute top-2 right-2 p-2 rounded-full bg-black/20 text-white hover:bg-black/40 transition-colors z-10",title:a(d?"removeFromFavorites":"addToFavorites"),"aria-label":a(d?"removeFromFavorites":"addToFavorites"),children:e.jsx(A,{className:`w-6 h-6 ${d?"fill-yellow-400 stroke-yellow-500":"fill-transparent stroke-white"}`})}),e.jsx("img",{src:t.imageUrl,alt:N,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[e.jsx(L,{status:t.status}),e.jsx("h3",{className:"text-lg font-bold text-ever-black mt-2",children:N}),e.jsx("p",{className:"text-sm text-gray-500",children:I}),e.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[a("rate"),":"]})," ",t.isReservable?`${t.rate.toLocaleString()} ${F}`:a("notReservable")]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-semibold",children:[a("location"),":"]})," ",t.location," ",C&&`(${C})`]}),h&&e.jsxs("p",{className:"text-xs text-yellow-600 font-semibold",children:[a("required"),": ",$]}),k&&e.jsxs("p",{className:"text-xs text-gray-600",children:[a("expert"),": ",k.name]})]}),e.jsxs("div",{className:"mt-auto pt-4 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[t.isReservable&&e.jsx("button",{onClick:()=>l({type:"scheduleEquipment",props:{equipment:t}}),className:"flex-1 bg-white hover:bg-gray-100 text-text-primary font-semibold py-2 px-4 rounded-lg border border-gray-300 transition-colors text-sm",children:a("schedule")}),e.jsx("button",{onClick:()=>l({type:"equipmentManuals",props:{equipment:t}}),className:`flex-1 font-semibold py-2 px-4 rounded-lg border transition-colors text-sm ${t.manualIds&&t.manualIds.length>0?"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100":"bg-white hover:bg-gray-100 text-text-primary border-gray-300"}`,children:a("manualsAndInfo")})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l({type:"bookEquipment",props:{equipment:t}}),disabled:!w,className:`w-full font-bold py-2 px-4 rounded-full transition-all duration-300 ${w?"bg-gradient-to-r from-ever-blue to-ever-purple text-white hover:shadow-lg":`bg-gray-300 text-gray-500 ${t.isReservable?"cursor-not-allowed":"opacity-50"}`}`,title:M(),children:a("bookEquipment")}),e.jsx("button",{onClick:()=>l({type:"reportIssue",props:{equipment:t}}),className:"flex-shrink-0 bg-yellow-500 hover:bg-yellow-600 text-white font-bold p-2 rounded-lg",title:a("reportIssue"),children:e.jsx(U,{})})]})]})]})]})},H=({equipmentList:t,sortConfig:s,requestSort:a})=>{const{equipmentManuals:i}=T(),{t:o,isJapanese:u}=f(),m=y.useMemo(()=>{let r=[...t];return s!==null&&r.sort((b,d)=>{const p=s.key==="name"?u?"nameJP":"nameEN":s.key,n=b[p],c=d[p];return n==null?1:c==null?-1:typeof n=="string"&&typeof c=="string"?s.direction==="ascending"?n.localeCompare(c):c.localeCompare(n):typeof n=="number"&&typeof c=="number"?s.direction==="ascending"?n-c:c-n:n<c?s.direction==="ascending"?-1:1:n>c?s.direction==="ascending"?1:-1:0}),r},[t,s,u]),l=r=>!s||s.key!==r?null:s.direction==="ascending"?" ▲":" ▼";return e.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsxs("th",{onClick:()=>a("name"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[o("equipmentName"),l("name")]}),e.jsxs("th",{onClick:()=>a("model"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[o("modelProductCode"),l("model")]}),e.jsxs("th",{onClick:()=>a("manufacturer"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[o("manufacturer"),l("manufacturer")]}),e.jsxs("th",{onClick:()=>a("rate"),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",children:[o("priceFee"),l("rate")]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:o("manuals")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.length>0?m.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u?r.nameJP:r.nameEN}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.model||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.manufacturer||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.isReservable?`${r.rate.toLocaleString()} ${u?r.rateUnitJP:r.rateUnitEN}`:o("notReservable")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsx("div",{className:"flex space-x-2",children:(r.manualIds||[]).map(b=>{const d=i.find(p=>p.id===b);return d?e.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",title:d.name,children:Q(d.type)},d.id):null})})})]},r.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:o("noEquipmentToDisplay")})})})]})})},G=()=>{const t=S(),{t:s}=f(),[a,i]=y.useState("grid"),[o,u]=y.useState({key:"name",direction:"ascending"}),m=l=>{let r="ascending";o&&o.key===l&&o.direction==="ascending"&&(r="descending"),u({key:l,direction:r})};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-ever-black",children:s("equipmentList")}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>i("grid"),className:`mr-2 p-2 rounded ${a==="grid"?"bg-ever-blue text-white":"bg-gray-200"}`,children:"Grid"}),e.jsx("button",{onClick:()=>i("table"),className:`p-2 rounded ${a==="table"?"bg-ever-blue text-white":"bg-gray-200"}`,children:"Table"})]})]}),a==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(l=>e.jsx(V,{equipment:l},l.id))}):e.jsx(H,{equipmentList:t,sortConfig:o,requestSort:m})]})};export{G as default};
