import{u as C,e as w,t as D,f as A,r as b,j as e}from"./index-B-QOVXil.js";import{u as L}from"./useAdminActions-oUyNlHWx.js";import"./App-gCA-TVeX.js";const I=()=>{var N;const{currentUser:u,isFacilityStaff:x}=C(),{t:a,isJapanese:n}=w(),{consumableNotifications:p}=D(),{showToast:j}=A(),{addConsumableNotification:y,updateConsumableNotificationStatus:r}=L(),[v,i]=b.useState(!1),[t,l]=b.useState({consumableId:"",location:"",priority:"MEDIUM",notes:""}),c=b.useMemo(()=>[{id:"hypochlorous-acid",nameJP:"æ¬¡äºœå¡©ç´ é…¸",nameEN:"Hypochlorous Acid Solution",locations:["Lab Area A","Lab Area B","Common Area"]},{id:"hand-soap",nameJP:"æ‰‹æ´—ã„çŸ³é¹¸",nameEN:"Hand Soap",locations:["Washroom 1F","Washroom 2F","Lab Area A","Lab Area B"]},{id:"hand-paper",nameJP:"ãƒãƒ³ãƒ‰ãƒšãƒ¼ãƒ‘ãƒ¼",nameEN:"Paper Towels",locations:["Washroom 1F","Washroom 2F","Lab Area A","Lab Area B"]},{id:"disinfectant-wipes",nameJP:"æ¶ˆæ¯’ç”¨ã‚¦ã‚§ãƒƒãƒˆãƒ†ã‚£ãƒƒã‚·ãƒ¥",nameEN:"Disinfectant Wipes",locations:["Lab Area A","Lab Area B","Common Area"]},{id:"gloves-disposable",nameJP:"ä½¿ã„æ¨ã¦æ‰‹è¢‹",nameEN:"Disposable Gloves",locations:["Lab Area A","Lab Area B"]}],[]),d={LOW:{labelKey:"priorityLow",color:"bg-gray-100 text-gray-700",icon:"ðŸ“‹"},MEDIUM:{labelKey:"priorityMedium",color:"bg-blue-100 text-blue-700",icon:"ðŸ“Œ"},HIGH:{labelKey:"priorityHigh",color:"bg-orange-100 text-orange-700",icon:"âš ï¸"},URGENT:{labelKey:"priorityUrgent",color:"bg-red-100 text-red-700",icon:"ðŸš¨"}},f={REPORTED:{labelKey:"statusReported",color:"bg-yellow-100 text-yellow-700"},ACKNOWLEDGED:{labelKey:"statusAcknowledged",color:"bg-blue-100 text-blue-700"},RESTOCKING:{labelKey:"statusRestocking",color:"bg-purple-100 text-purple-700"},COMPLETED:{labelKey:"statusCompleted",color:"bg-green-100 text-green-700"}},E=()=>{if(!t.consumableId||!t.location||!u){j(a("selectConsumableAndLocation"),"error");return}const s=c.find(o=>o.id===t.consumableId);s&&(y({consumableId:t.consumableId,consumableName:s.nameEN,consumableNameJP:s.nameJP,consumableNameEN:s.nameEN,location:t.location,currentStock:0,minimumStock:0,unit:a("unitItems"),priority:t.priority,notes:t.notes,reportedBy:u.id,reportedDate:new Date,status:"REPORTED"}),l({consumableId:"",location:"",priority:"MEDIUM",notes:""}),i(!1))},h=p.filter(s=>s.status!=="COMPLETED"),m=p.filter(s=>s.status==="COMPLETED");return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:a("facilityConsumablesShortageNotification")}),!x&&e.jsxs("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸš¨"}),e.jsx("span",{children:a("reportShortage")})]})]}),v&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow mb-6 border-2 border-red-200",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-red-700",children:a("reportConsumableShortage")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[a("consumable")," *"]}),e.jsxs("select",{value:t.consumableId,onChange:s=>l({...t,consumableId:s.target.value,location:""}),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"",children:a("select")}),c.map(s=>e.jsx("option",{value:s.id,children:n?s.nameJP:s.nameEN},s.id))]})]}),t.consumableId&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[a("location")," *"]}),e.jsxs("select",{value:t.location,onChange:s=>l({...t,location:s.target.value}),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"",children:a("select")}),(N=c.find(s=>s.id===t.consumableId))==null?void 0:N.locations.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:a("priorityLevel")}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Object.keys(d).map(s=>{const o=d[s];return e.jsxs("button",{type:"button",onClick:()=>l({...t,priority:s}),className:`p-3 rounded border-2 transition-all ${t.priority===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:o.icon}),e.jsx("div",{className:"text-sm font-medium",children:a(o.labelKey)})]},s)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:a("notes")}),e.jsx("textarea",{value:t.notes,onChange:s=>l({...t,notes:s.target.value}),className:"w-full border rounded p-2",rows:2,placeholder:a("notesPlaceholder")})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:a("cancel")}),e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:a("submitReport")})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"p-4 border-b bg-gray-50",children:e.jsx("h3",{className:"font-bold",children:a("activeNotifications")})}),e.jsx("div",{className:"divide-y",children:h.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500",children:a("noActiveNotifications")}):h.map(s=>{const o=d[s.priority],g=f[s.status];return e.jsxs("div",{className:"p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl",children:o.icon}),e.jsx("span",{className:"font-bold text-lg",children:n?s.consumableNameJP:s.consumableNameEN}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${o.color}`,children:a(o.labelKey)})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsxs("span",{className:"font-medium",children:[a("location"),": "]}),s.location]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsxs("span",{className:"font-medium",children:[a("reportDate"),": "]}),new Date(s.reportedDate).toLocaleString(n?"ja-JP":"en-US")]}),s.notes&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-2 rounded mt-2",children:s.notes})]}),e.jsx("div",{className:"ml-4",children:e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded ${g.color}`,children:a(g.labelKey)})})]}),x&&e.jsxs("div",{className:"flex gap-2 mt-3",children:[s.status==="REPORTED"&&e.jsx("button",{onClick:()=>r(s.id,"ACKNOWLEDGED"),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:a("acknowledge")}),s.status==="ACKNOWLEDGED"&&e.jsx("button",{onClick:()=>r(s.id,"RESTOCKING"),className:"px-3 py-1 bg-purple-600 text-white text-sm rounded hover:bg-purple-700",children:a("startRestocking")}),s.status==="RESTOCKING"&&e.jsx("button",{onClick:()=>r(s.id,"COMPLETED"),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:a("complete")})]})]},s.id)})})]}),m.length>0&&e.jsxs("details",{className:"bg-white rounded-lg shadow",children:[e.jsxs("summary",{className:"p-4 cursor-pointer hover:bg-gray-50 font-bold",children:[a("completedNotificationsHistory")," ",e.jsxs("span",{className:"ml-2 text-gray-500",children:["(",m.length,")"]})]}),e.jsx("div",{className:"divide-y border-t",children:m.map(s=>{var o;return e.jsxs("div",{className:"p-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:n?s.consumableNameJP:s.consumableNameEN}),e.jsx("span",{className:"text-gray-500",children:(o=s.restockedDate)==null?void 0:o.toLocaleDateString()})]}),e.jsx("div",{className:"text-gray-600 text-xs mt-1",children:s.location})]},s.id)})})]})]})};export{I as default};
