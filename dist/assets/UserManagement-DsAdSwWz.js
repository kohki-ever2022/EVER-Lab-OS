import{d as M,h as I,e as R,f as q,r as o,j as e,R as b,a as D}from"./index-B-QOVXil.js";import{a as E,u as P}from"./App-gCA-TVeX.js";const J=()=>{const f=M(),{companies:m}=I(),{t:a,isJapanese:x}=R(),{showToast:n}=q(),{hasPermission:j}=E(),{addUser:w,updateUser:v,deleteUser:N}=P(),[k,u]=o.useState(!1),[l,d]=o.useState(null),[i,h]=o.useState(!1),C=j("users","manage"),p=(s=null)=>{d(s||{role:b.Researcher,roleCategory:D.Tenant}),u(!0)},g=()=>{u(!1),d(null)},U=async s=>{if(s.preventDefault(),!l)return;h(!0);let t;l.id?t=await v(l):t=await w(l),t.success===!1?n(t.error.message,"error"):(n(a("userSaved"),"success"),g()),h(!1)},S=async s=>{if(window.confirm(a("deleteUserConfirm"))){const t=await N(s);t.success===!1?n(t.error.message,"error"):n(a("userDeleted"),"success")}},r=s=>{const{name:t,value:c}=s.target;d(y=>y?{...y,[t]:c}:null)};return C?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-ever-black",children:a("userManagement")}),e.jsx("button",{onClick:()=>p(),className:"bg-ever-blue hover:bg-ever-blue-dark text-white font-bold py-2 px-4 rounded-lg",children:a("addNewUser")})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("name")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("emailAddress")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("company")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("role")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(s=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(t=m.find(c=>c.id===s.companyId))==null?void 0:t[x?"nameJP":"nameEN"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.role}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>p(s),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:a("edit")}),e.jsx("button",{onClick:()=>S(s.id),className:"text-red-600 hover:text-red-900",children:a("delete")})]})]},s.id)})})]})}),k&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:l.id?a("editUser"):a("addNewUser")}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("name")}),e.jsx("input",{type:"text",name:"name",value:l.name||"",onChange:r,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("emailAddress")}),e.jsx("input",{type:"email",name:"email",value:l.email||"",onChange:r,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("company")}),e.jsxs("select",{name:"companyId",value:l.companyId||"",onChange:r,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:a("selectCompany")}),m.map(s=>e.jsx("option",{value:s.id,children:x?s.nameJP:s.nameEN},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:a("role")}),e.jsx("select",{name:"role",value:l.role||"",onChange:r,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:!0,children:Object.values(b).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:g,className:"bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg disabled:opacity-50",disabled:i,children:a("cancel")}),e.jsx("button",{type:"submit",className:"bg-ever-blue text-white font-bold py-2 px-4 rounded-lg disabled:bg-gray-400",disabled:i,children:a(i?"saving":"save")})]})]})]})})]}):e.jsx("div",{className:"p-6",children:a("permissionDenied")})};export{J as default};
