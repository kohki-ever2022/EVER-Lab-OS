import{u as p,e as m,t as y,v as g,j as e,o as f,r as C,p as r,f as N}from"./index-B-QOVXil.js";import{f as b}from"./App-gCA-TVeX.js";const k=()=>{const{currentUser:a}=p(),{t:c,isJapanese:o}=m(),{waitlist:i}=y(),d=g(),{removeFromWaitlist:s}=b(),u=i.filter(n=>n.userId===(a==null?void 0:a.id)&&n.status==="Pending");return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:c("waitlist")}),u.length===0?e.jsx("p",{className:"text-gray-500",children:c("noWaitlists")}):e.jsx("ul",{className:"space-y-4",children:u.map(n=>{const t=d.find(x=>x.id===n.equipmentId);return e.jsxs("li",{className:"border-b pb-2",children:[e.jsx("p",{className:"font-semibold",children:o?t==null?void 0:t.nameJP:t==null?void 0:t.nameEN}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c("requestedTime")," ",new Date(n.requestedStartTime).toLocaleString()]}),e.jsx("button",{onClick:()=>s(n.id),className:"text-red-500 text-xs mt-1",children:c("cancel")})]},n.id)})})]})},h=({reservation:a})=>{const c=g(),{showToast:o}=N(),{checkOutReservation:i,updateReservation:d}=b(),{t:s,isJapanese:u}=m(),n=c.find(l=>l.id===a.equipmentId),x={[r.AwaitingCheckIn]:{text:s("statusAwaitingCheckIn"),color:"text-blue-600"},[r.CheckedIn]:{text:s("statusInUse"),color:"text-green-600"},[r.Completed]:{text:s("statusCompleted"),color:"text-gray-600"},[r.Cancelled]:{text:s("statusCancelled"),color:"text-orange-600"},[r.NoShow]:{text:s("statusNoShow"),color:"text-red-600"},[r.Upcoming]:{text:s("statusUpcoming"),color:"text-gray-600"}}[a.status],w=async()=>{const l=await d({...a,status:r.CheckedIn,actualStartTime:new Date});l.success===!1?o(`${s("checkInFailed")}: ${l.error.message}`,"error"):o(s("checkInSuccess"),"success")},v=async()=>{const l=await i(a.id);l.success===!1?o(`${s("checkOutFailed")}: ${l.error.message}`,"error"):o(s("checkOutSuccess"),"success")},j=async()=>{if(window.confirm(s("cancelReservationConfirm"))){const l=await d({...a,status:r.Cancelled});l.success===!1?o(`${s("cancelFailed")}: ${l.error.message}`,"error"):o(s("cancelSuccess"),"success")}};return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[e.jsx("h4",{className:"font-bold",children:u?n==null?void 0:n.nameJP:n==null?void 0:n.nameEN}),e.jsx("p",{className:`text-sm font-semibold ${x.color}`,children:x.text}),e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(a.startTime).toLocaleString()," - ",new Date(a.endTime).toLocaleTimeString()]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[a.status===r.AwaitingCheckIn&&e.jsx("button",{onClick:w,className:"bg-green-500 text-white px-3 py-1 text-sm rounded",children:s("checkIn")}),a.status===r.CheckedIn&&e.jsx("button",{onClick:v,className:"bg-blue-500 text-white px-3 py-1 text-sm rounded",children:s("checkOut")}),a.status===r.AwaitingCheckIn&&e.jsx("button",{onClick:j,className:"bg-red-500 text-white px-3 py-1 text-sm rounded",children:s("cancel")})]})]})},S=()=>{const{currentUser:a}=p(),{t:c}=m(),o=f(),[i,d]=C.useState("current"),s=o.filter(t=>t.userId===(a==null?void 0:a.id)),u=s.filter(t=>t.status===r.AwaitingCheckIn||t.status===r.CheckedIn),n=s.filter(t=>t.status===r.Completed||t.status===r.Cancelled||t.status===r.NoShow);return e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-ever-black",children:c("myReservations")}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>d("current"),className:`${i==="current"?"border-ever-blue text-ever-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[c("currentReservations")," (",u.length,")"]}),e.jsxs("button",{onClick:()=>d("history"),className:`${i==="history"?"border-ever-blue text-ever-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[c("history")," (",n.length,")"]}),e.jsx("button",{onClick:()=>d("waitlist"),className:`${i==="waitlist"?"border-ever-blue text-ever-blue":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:c("waitlist")})]})}),i==="current"&&(u.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.map(t=>e.jsx(h,{reservation:t},t.id))}):e.jsx("p",{className:"text-gray-500",children:c("noCurrentReservations")})),i==="history"&&(n.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:n.map(t=>e.jsx(h,{reservation:t},t.id))}):e.jsx("p",{className:"text-gray-500",children:c("noReservationHistory")})),i==="waitlist"&&e.jsx(k,{})]})};export{S as default};
